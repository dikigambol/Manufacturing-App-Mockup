/* ========================================
   Machine Layout Widget - Scoped Styles
   ======================================== 
   
   This CSS is ONLY for the dashboard widget view
   NOT for the Layout Designer page
   ======================================== */

/* Widget Container */
.machine-layout-widget {
    position: relative;
    width: 100%;
    height: 100%;
    background: rgb(17, 24, 39);
}

/* Nodes - Interactive with hover scale */
.machine-layout-widget .react-flow__node {
    cursor: pointer;
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    transform-origin: center center;
    /* GPU acceleration for smooth scaling */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    will-change: transform;
    /* Prevent sub-pixel rendering issues */
    transform: translate3d(0, 0, 0);
    /* Force hardware acceleration */
    -webkit-transform: translate3d(0, 0, 0);
}

/* Hover effect - scale up for click affordance */
.machine-layout-widget .react-flow__node:hover {
    transform: scale(1.05) translate3d(0, 0, 0);
    -webkit-transform: scale(1.05) translate3d(0, 0, 0);
    z-index: 1000;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

/* Ensure no transform happens when not hovering */
.machine-layout-widget .react-flow__node:not(:hover) {
    transform: scale(1) translate3d(0, 0, 0);
    -webkit-transform: scale(1) translate3d(0, 0, 0);
}

/* Selected node styling */
.machine-layout-widget .react-flow__node.selected {
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
}

/* Disable ALL animations to prevent jumping */
.machine-layout-widget .react-flow__node .animate-pulse,
.machine-layout-widget .react-flow__node .animate-ping,
.machine-layout-widget .react-flow__node .animate-bounce,
.machine-layout-widget .react-flow__node .animate-spin,
.machine-layout-widget .react-flow__node [class*="animate-"] {
    animation: none !important;
}

/* Prevent layout shift on any child elements */
.machine-layout-widget .react-flow__node *,
.machine-layout-widget .react-flow__node *::before,
.machine-layout-widget .react-flow__node *::after {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
}

/* Stable positioning for absolute elements */
.machine-layout-widget .react-flow__node .absolute {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
}

/* Prevent transform on child elements during parent hover */
.machine-layout-widget .react-flow__node:hover * {
    transform: translateZ(0) !important;
    -webkit-transform: translateZ(0) !important;
}

/* Edge (connection lines) styling */
.machine-layout-widget .react-flow__edge-path {
    stroke-width: 3;
    transition: stroke-width 0.2s ease-in-out;
}

.machine-layout-widget .react-flow__edge:hover .react-flow__edge-path {
    stroke-width: 4;
}

/* Background grid */
.machine-layout-widget .react-flow__background {
    background-color: rgb(17, 24, 39);
}

/* Controls (zoom buttons) */
.machine-layout-widget .react-flow__controls {
    background: rgb(31, 41, 55);
    border: 2px solid rgb(55, 65, 81);
    border-radius: 8px;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
}

.machine-layout-widget .react-flow__controls-button {
    background: rgb(31, 41, 55);
    border-bottom: 1px solid rgb(55, 65, 81);
    color: rgb(156, 163, 175);
    transition: all 0.2s ease-in-out;
}

.machine-layout-widget .react-flow__controls-button:hover {
    background: rgb(55, 65, 81);
    color: rgb(59, 130, 246);
}

.machine-layout-widget .react-flow__controls-button:last-child {
    border-bottom: none;
}

/* MiniMap */
.machine-layout-widget .react-flow__minimap {
    background: rgb(31, 41, 55);
    border: 2px solid rgb(55, 65, 81);
    border-radius: 8px;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
    cursor: grab;
    transition: all 0.2s ease-in-out;
}

.machine-layout-widget .react-flow__minimap:hover {
    border-color: rgb(59, 130, 246);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2), 0 10px 15px -3px rgba(0, 0, 0, 0.3);
}

.machine-layout-widget .react-flow__minimap:active {
    cursor: grabbing;
    border-color: rgb(34, 211, 238);
}

/* MiniMap mask (viewport indicator) - make it more visible */
.machine-layout-widget .react-flow__minimap-mask {
    fill: rgba(59, 130, 246, 0.15);
    stroke: rgb(59, 130, 246);
    stroke-width: 2;
}

/* MiniMap nodes */
.machine-layout-widget .react-flow__minimap-node {
    cursor: pointer;
}

/* Info banner styling */
.machine-layout-widget .info-banner {
    position: absolute;
    top: 8px;
    left: 8px;
    z-index: 10;
    background: rgba(31, 41, 55, 0.9);
    backdrop-filter: blur(8px);
    border: 1px solid rgb(55, 65, 81);
    border-radius: 8px;
    padding: 6px 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Status legend styling */
.machine-layout-widget .status-legend {
    position: absolute;
    bottom: 8px;
    left: 60px;
    z-index: 10;
    background: rgba(31, 41, 55, 0.95);
    backdrop-filter: blur(8px);
    border: 1px solid rgb(55, 65, 81);
    border-radius: 8px;
    padding: 8px 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    display: flex;
    gap: 16px;
    align-items: center;
}

.machine-layout-widget .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: rgb(209, 213, 219);
    font-weight: 500;
}

.machine-layout-widget .legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    box-shadow: 0 0 8px currentColor;
    flex-shrink: 0;
}

/* Prevent any transition during React Flow internal updates */
.machine-layout-widget .react-flow__node.updating {
    transition: none !important;
}

/* Ensure handles are visible but don't interfere */
.machine-layout-widget .react-flow__handle {
    opacity: 0;
    pointer-events: none;
}

/* Loading state */
.machine-layout-widget .loading-container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background: rgb(17, 24, 39);
    color: rgb(156, 163, 175);
}

/* Empty state */
.machine-layout-widget .empty-container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background: rgb(17, 24, 39);
    color: rgb(156, 163, 175);
}